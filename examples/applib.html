<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>JSConf code example</title>

    <script src="../dist/rocky-0.1.0.js"></script>
    <link rel="stylesheet" href="../css/bootstrap.min.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="container">
    <div class="page-header">
        <h1>JSConf code example</h1>
        <p class="lead">
            This is the example <a href="https://youtu.be/2TslKh1tdm4?t=14m5s">as seen at JSConf (YouTube)</a>.<br>
            Look at the HTML source to learn how simple it is to use RockyJS.
            In addition to <code>var rocky = Rocky.bindCanvas(element)</code> this example also uses
            <code>rocky.export_global_c_symbols()</code> to get very close to <a href="https://developer.getpebble.com/docs/c/">today's C-API for Pebble</a>
            (read: pollute the global namespace).
        </p>
    </div>

<canvas id="pebble" width="432" height="504"></canvas>
</div>
</body>
<script>
    (function () {
        var rocky = Rocky.bindCanvas(document.getElementById("pebble"));
        // puts all C-symbols from rocky onto window.* so they can be used almost
        // the same way you were using them in C
        rocky.export_global_c_symbols();

        var value = 0;
        rocky.update_proc = function (ctx, bounds) {
            graphics_context_set_stroke_color(ctx, GColorRed);
            graphics_context_set_stroke_width(ctx, 10);
            graphics_draw_line(ctx, [value, 0], [100, value]);

            var rect = rocky.GRect(10, 10, 125, 125);
            graphics_fill_radial(
                    ctx, bounds,
                    GOvalScaleModeFitCircle,
                    20, /* inset */
                    DEG_TO_TRIGANGLE(value), /* angle_start */
                    DEG_TO_TRIGANGLE(value * 2)  /* angle_end */
            );
        };

        setInterval(function () {
            value += 1;
            rocky.mark_dirty();
        }, 1000 / 20);

        rocky.mark_dirty();
    })();
</script>
</html>

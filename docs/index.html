<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Rocky.js</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="container">
    <h1 id="api-documentation">API Documentation</h1>
<p>This document is split into two major sections:</p>
<ul>
<li><a href="#rockyjs-web-api">Rocky.js Web API</a> - The APIs used to create and update an instance of Rocky.js on a webpage.</li>
<li><a href="#pebble-api-compatibility">Pebble API Compatibility</a> - A subset of Pebble&#39;s <a href="https://developer.pebble.com/docs/c">C-style API</a> that can invoked through JavaScript.</li>
</ul>
<h2 id="rocky-js-web-api">Rocky.js Web API</h2>
<p>Rocky.js exposes a number of helper functions outside Pebble&#39;s C-Style API to help you work with Rocky.js in a browser based environment. </p>
<h3 id="rocky-bindcanvas-el-">Rocky.bindCanvas(el)</h3>
<p>The <code>bindCanvas</code> method creates an instance of Rocky.js, binds that instance to the supplied canvas element, then returns the instance to be used later in code. </p>
<pre><code class="lang-js">// Create an instance of Rocky.js and bind it to a canvas with id=&quot;pebble&quot;
var rocky = Rocky.bindCanvas(document.getElementById(&quot;pebble&quot;));
</code></pre>
<h3 id="rocky-export_global_c_symbols-">rocky.export_global_c_symbols()</h3>
<p>Rocky exposes a <a href="#pebble-api-compatibility">subset of Pebble&#39;s C-Style</a> that can invoked with <code>rocky.c_api_function_name(...)</code>. The <code>export_global_c_symbols</code> adds all of the available methods from the C-Style API to the global namespace, removing the need to preface each API call with <code>rocky.</code>.</p>
<p>The following two examples demonstrate how <code>rocky.export_global_c_symbols()</code> affects a simple implementation:</p>
<pre><code>// Calling a C-Style API without rocky.export_global_c_symbols
var rocky = Rocky.bindCanvas(document.getElementById(&quot;pebble&quot;));

rocky.update_proc = function (ctx, bounds) {
    rocky.graphics_context_set_stroke_color(ctx, rocky.GColorRed);
    rocky.graphics_context_set_stroke_width(ctx, 10);
    rocky.graphics_draw_line(ctx, [50, 0], [100, 50]);
};
</code></pre><pre><code>// Calling a C-Style API after rocky.export_global_c_symbols
var rocky = Rocky.bindCanvas(document.getElementById(&quot;pebble&quot;));
rocky.export_global_c_symbols();

rocky.update_proc = function (ctx, bounds) {
    graphics_context_set_stroke_color(ctx, GColorRed);
    graphics_context_set_stroke_width(ctx, 10);
    graphics_draw_line(ctx, [50, 0], [100, 50]);
};
</code></pre><p><strong>NOTE 1:</strong> This method should <em>only</em> be invoked in isolated playgrounds when there is a single instance of Rocky.</p>
<p><strong>NOTE 2:</strong> Adding functions to the global namespace is generally considered an anti-pattern. The <code>export_global_c_symbols</code> may be invoked with an optional parameter (a namespace object) - when invoked in this way, the functions will be bound to the namespace object rather than the window.</p>
<h3 id="rocky-mark_dirty-">rocky.mark_dirty()</h3>
<p>The <code>mark_dirty</code> method indicates to the specified instance of Rocky that <code>rocky.update_proc</code> should be invoked. </p>
<pre><code>var rocky = Rocky.bindCanvas(document.getElementById(&quot;pebble&quot;));

var value = 0;

rocky.update_proc = function(ctx, bounds)  {
    graphics_context_set_stroke_color(ctx, GColorRed);
    graphics_context_set_stroke_width(ctx, 10);
    graphics_draw_line(ctx, [value, 0], [100, value]);
};

// Update value and mark the canvas as dirty 20/sec
setInterval(function() {
    value += 1;
    rocky.mark_dirty();
}, 1000 / 20);
</code></pre><h3 id="rocky-update_proc">rocky.update_proc</h3>
<p>Instances of Rocky.js include a property, <code>update_proc</code>, that will be invoked each time the instance is marked dirty with <code>rocky.mark_dirty</code>. The update_proc method should be set to a callback function with parameters: </p>
<ul>
<li><code>ctx</code>: A JavaScript version of the <a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Context/">GContext</a> object.</li>
<li><code>bounds</code>: A JavaScript version of the <a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Types/#GRect">GRect</a> object indicating the bounds of the virtual display.</li>
</ul>
<p>See <a href="#rocky-mark_dirty">rocky.mark_dirty</a> for sample usage.</p>
<h2 id="pebble-api-compatibility">Pebble API Compatibility</h2>
<p>Rocky.js currently implements a subset of Pebble&#39;s C-Style API. This section of the document outlines what methods have been implemented, as well as recommendations for how to manage some of the sections of the API that are not implemented.</p>
<table class="table table-bordered table-compatibility">
    <thead><tr>
        <th>C API</th> 
        <th>Status</th>
        <th>Notes</th>
    </tr></thead>
    <tbody>

    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/AccelerometerService/">Accelerometer Service</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Detecting_device_orientation">Device Motion and Orientation APIs</a></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Animation/">Animation</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval">setInterval</a></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/AppFocusService/">AppFocus Service</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/AppMessage/">AppMessage</a></td>
        <td>Planned</td>
        <td>Will use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">WebWorker</a> semantics</td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/AppSyn/">AppSync</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/BatteryStateService/">Battery Service</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Battery_Status_API">BatteryStatus API</a></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Types/#gbitmap_get_bytes_per_row">Bitmap</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Types/#gbitmap_sequence_create_with_resource">BitmapSequence</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Clicks/">Clicks</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/CompassService/">Compass Service</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Detecting_device_orientation">Device Motion and Orientation APIs</a></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/ConnectionService/">Connection Service</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/DataLogging/">DataLogging</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="standard">
        <td>Date/Time</td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Dictation/">Dictation</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API">Web Speech API</a></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Draw_Commands/">DrawCommand</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Drawing_Paths/">Drawing Paths</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="partial">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Drawing_Primitives/">Drawing Primitives</a></td>
        <td>Partial</td>
        <td>Bitmap and framebuffer APIs not currently implemented</td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Drawing_Text/">Drawing Text</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Fonts/">Fonts</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="partial">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Context/">Graphics Context</a></td>
        <td>Partial</td>
        <td>Not Implemented: graphics_context_set_text_color and graphics_context_compositing_mode</td>
    </tr>
    <tr class="partial">
        <td><a href="https://developer.pebble.com/docs/c/Graphics/Graphics_Types/">Graphics Types</a></td>
        <td>Partial</td>
        <td>Currently Implemented: GColor, GPoint, GRect (modified)</td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Memory_Management/">Heap</a></td>
        <td>Not Currently Planned</td>
        <td>Still investigating memory management</td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Launch_Reason/">Launch Reason</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Layers/">Layer</a></td>
        <td>Planned</td>
        <td>Or similar functionality</td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Logging/">Logging</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Console/log">console.log</a></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Light/">Light</a></td>
        <td>Planned</td>
        <td></td>
    </tr>

    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Storage/">Persistant Storage</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">localStorage API</a></td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Smartstrap/">SmartStraps</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Event_Service/TickTimerService/">TickService</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval">setInterval</a></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Timer/">Timer</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setInterval">setInterval</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout">setTimeout</a></td>
    </tr>
    <tr class="standard">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Vibes/">Vibes</a></td>
        <td>Standard JS/HTML5 API</td>
        <td>Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/vibrate">Navigator.vibrate</a></td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/Wakeup/">Wakeup</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/Foundation/WatchInfo/">WatchInfo</a></td>
        <td>Planned</td>
        <td></td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Window/">Window</a></td>
        <td>Planned</td>
        <td>Or similar functionality</td>
    </tr>
    <tr class="planned">
        <td><a href="https://developer.pebble.com/docs/c/User_Interface/Window_Stack/">WindowStack</a></td>
        <td>Planned</td>
        <td>Or similar functionality</td>
    </tr>
    <tr class="not-planned">
        <td><a href="https://developer.pebble.com/docs/c/Worker/">Worker</a></td>
        <td>Not Currently Planned</td>
        <td></td>
    </tr>
    </tbody>
</table>

    <a id="githubForkLink" href="https://github.com/pebble/rockyjs.git">Fork me on GitHub</a>

</div>

</body>
</html>
